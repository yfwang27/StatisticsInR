Outline
library(knitr)
install.packages(knitr)
knitr
install.packages("knitr")
$$
lmExample <- read.table("data/lmExample.txt",h=T,sep="\t")
lmExample
vote.leave=17410742
vote.remain=16141241
prop.test(vote.leave, 33551983, p=0.5, alternative = "less")
prop.test(vote.remain, 33551983, p=0.5, alternative = "less")
total.vote=vote.leave+vote.remain
total.vote
vote.leave-vote.remain
vote.leave/total.vote
vote.remain/total.vote
?biom.test
?binom.test
binom.test(vote.leave, 33551983, p=0.5, alternative = "less")
vote.leave/total.vote
lmExample <- read.table("data/lmExample.txt",h=T,sep="\t")
lmResult <- lm(Y~X,data=lmExample)
plot(Y~X,data=lmExample,main="Line of best fit with lm()",
xlim=c(0,150),ylim=c(0,200))
abline(lmResult,col="red",lty=3,lwd=3)
lmExample
dim(lmExample)
head(lmExample)
summary(lmResult)
summary(resid(lmResult))
summary(lmResult$residual)
summary(lmResult)
SSE <- sum(resid(lmResult)^2)
TSS <- sum((lmExample$Y - mean(lmExample$Y))^2)
1- SSE/TSS
summary(lmResult)$r.squared
MSE <- mean(lmResult$residuals^2)
RSS <- sum((predict(lmResult) - mean(lmExample$Y))^2)
summary(lmResult)$fstatistic
binom.test(vote.leave, total.vote, p=0.5, alternative = "less")
prop.test(vote.remain, total.vote, p=0.5, alternative = "less")
binom.test(vote.leave, total.vote, p=0.5, alternative = "two.sided")
binom.test(vote.leave, total.vote, p=0.5, alternative = "less")
par(mfrow=c(2,1))
hist(Life_exp$life.expectancy,breaks=10,freq = F,xlim=range(Life_exp$life.expectancy))
lines(density(Life_exp$life.expectancy),col="red",lwd=3)
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)",horizontal=T, ylim=range(Life_exp$life.expectancy))
abline(v=mean(Life_exp$life.expectancy),col="forestgreen",lwd=3)
par(mfrow=c(1,1))
par(mfrow=c(2,1))
hist(Life_exp$life.expectancy,breaks=10,freq = F,xlim=range(Life_exp$life.expectancy))
lines(density(Life_exp$life.expectancy),col="red",lwd=3)
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)",horizontal=T, ylim=range(Life_exp$life.expectancy))
abline(v=mean(Life_exp$life.expectancy),col="forestgreen",lwd=3)
par(mfrow=c(1,1))
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)",horizontal=T, ylim=range(Life_exp$life.expectancy))
setwd("/CSC/workshop/StatInR")
Life_exp<-read.csv("data/Life_expectancy_at_birth.csv",header=T)
plot(Life_exp$life.expectancy,ylab="Life expectancy (Years)")
min.life.exp<-min(Life_exp$life.expectancy)
max.life.exp<-max(Life_exp$life.expectancy)
median.life.exp<-median(Life_exp$life.expectancy)
mean.life.exp<-mean(Life_exp$life.expectancy)
c(min.life.exp, max.life.exp, median.life.exp, mean.life.exp)
range(Life_exp$life.expectancy)
quantile(Life_exp$life.expectancy)
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)")
abline(h=mean(Life_exp$life.expectancy),col="forestgreen",lwd=3)
c(min.life.exp, max.life.exp)
c(median.life.exp, mean.life.exp)
quantile(Life_exp$life.expectancy)[c(2,4)]
par(mfrow=c(1,2))
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)")
plot(sort(Life_exp$life.expectancy),ylab="Life expectancy (Years)")
points(x=c(1,median(1:nrow(Life_exp)),nrow(Life_exp)),
y=c(min(Life_exp$life.expectancy),
median(Life_exp$life.expectancy),max(Life_exp$life.expectancy)),
col="red",pch=16,cex=1.6)
abline(h=quantile(Life_exp$life.expectancy)[c(2,4)],
v=quantile(c(1:nrow(Life_exp)))[c(2,4)],col="pink")
par(mfrow=c(1,1))
var.life.exp<-sum((Life_exp$life.expectancy-mean.life.exp)^2)/(nrow(Life_exp)-1)
sd.life.exp<-sqrt(var.life.exp)
c(var.life.exp, sd.life.exp)
var(Life_exp$life.expectancy)
sd(Life_exp$life.expectancy)
hist(Life_exp$life.expectancy,breaks=10)
hist(Life_exp$life.expectancy,breaks=10,freq = F)
lines(density(Life_exp$life.expectancy),col="red")
par(mfrow=c(2,1))
hist(Life_exp$life.expectancy,breaks=10,freq = F,xlim=range(Life_exp$life.expectancy))
lines(density(Life_exp$life.expectancy),col="red",lwd=3)
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)",horizontal=T, ylim=range(Life_exp$life.expectancy))
abline(v=mean(Life_exp$life.expectancy),col="forestgreen",lwd=3)
par(mfrow=c(1,1))
install.packages(vioplot)
install.packages("vioplot")
library("vioplot")
boxplot(Life_exp$life.expectancy,ylab="Life expectancy (Years)",horizontal=T,ylim=range(Life_exp$life.expectancy))
```
vioplot(Life_exp$life.expectancy)
vioplot(Life_exp$life.expectancy,ylim=range(Life_exp$life.expectancy))
?vioplot
vioplot(Life_exp$life.expectancy,ylim=range(Life_exp$life.expectancy),horizontal = T)
?dist
intall.packages("knitr")
minRep <- rbind(cbind(matrix(rnorm(12,4),ncol=3,byrow = T),
matrix(c(rnorm(9,4),rnorm(3,8)),ncol=3,byrow = T)),
cbind(matrix(rnorm(12,10),ncol=3,byrow = T),
matrix(c(rnorm(6,3),rnorm(6,10)),ncol=3,byrow = T)))
colnames(minRep) <- paste0(c("Sample_"),
1:5,".",sort(rep(c("hi","low"),3)))
minRepdf <- data.frame(Gene_Name=paste("Gene",letters[1:8],sep="_"),minRep)
head(minRepdf)
cor(minRep)[1:2,2:5]
cor(minRep)[1:2,2:5,drop=F]
cor(minRepdf)[1:2,2:5]
image(cor(minRep),axes=F)
axis(1,at=seq(0,1,length.out=6), colnames(minRep))
axis(2,at=seq(0,1,length.out=6), colnames(minRep))
vote.leave=17410742
vote.remain=16141241
total.vote=vote.leave+vote.remain
binom.test(vote.leave, total.vote, p=0.5, alternative = "less")
head(iris)
iris4cor<-iris[,1:4]
cor(iris4cor)
?cor
?swiss
swiss
cor(swiss)
iris4cor<-iris[,1:4]
cor(iris4cor)
colnames(iris4cor)
?image
image(cor(iris4cor),axes=F,cex.lab=0.6)
axis(1,at=seq(0,1,length.out=4),colnames(iris4cor),las=2)
axis(2,at=seq(0,1,length.out=4),rev(colnames(iris4cor)),las=2)
image(cor(iris4cor),axes=F,cex.lab=0.6,cex.axis=0.4)
image(cor(iris4cor),axes=F,cex.lab=0.6,cex.axis=0.8)
axis(1,at=seq(0,1,length.out=4),colnames(iris4cor),las=2)
colnames(iris4cor)
image(cor(iris4cor),axes=F)
#mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
#mtext(rev(colnames(iris4cor)),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
axis(1,at=seq(0,1,length.out=4),colnames(iris4cor),las=2,cex=0.8)
axis(2,at=seq(0,1,length.out=4),rev(colnames(iris4cor)),las=2,cex=0.8)
colnames(iris4cor)
colnames(iris4cor)<-c("S.Len","S.Wid","P.Len","P.Wid")
image(cor(iris4cor),axes=F)
#mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
#mtext(rev(colnames(iris4cor)),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
axis(1,at=seq(0,1,length.out=4),colnames(iris4cor),las=2,cex=0.8)
axis(2,at=seq(0,1,length.out=4),rev(colnames(iris4cor)),las=2,cex=0.8)
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
mtext(rev(colnames(iris4cor)),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
iris4cor<-iris[,1:4]
head(iris4cor)
cor(iris4cor)
image(cor(iris4cor),axes=F,col=redblue(10))
image(cor(iris4cor),axes=F,col=heat.colors(6))
image(cor(iris4cor),axes=F,col=YlOrRd(6))
image(cor(iris4cor),axes=F,col=heat.colors(30))
mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
mtext(rev(colnames(iris4cor)),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
gsub("(.+)(\\.)()","\\3",colnames(iris4cor))
gsub("(.+)(\\.)(\\w{3})(.+)","\\3",colnames(iris4cor))
colnames(iris4cor)<-gsub("(.+)(\\.)(\\w{3})(.+)","\\1\\2\\3",colnames(iris4cor))
head(iris4cor)
cor(iris4cor)
cor(iris4cor)
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
mtext(rev(colnames(iris4cor)),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=2,at=seq(0,1,length.out=4),las=2,cex=0.8)
mtext(rev(colnames(iris4cor)),side=1,at=seq(0,1,length.out=4),las=1,cex=0.8)
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
mtext(rev(colnames(iris4cor)),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
?image
x <- 10*(1:nrow(volcano))
y <- 10*(1:ncol(volcano))
image(x, y, volcano, col = terrain.colors(100), axes = FALSE)
contour(x, y, volcano, levels = seq(90, 200, by = 5),
add = TRUE, col = "peru")
axis(1, at = seq(100, 800, by = 100))
axis(2, at = seq(100, 600, by = 100))
image(cor(iris4cor),axes=F)
mtext(colnames(iris4cor),side=2,at=seq(0,1,length.out=4),las=1,cex=0.8)
mtext(colnames(iris4cor),side=1,at=seq(0,1,length.out=4),las=2,cex=0.8)
image.scale()
lmResult
summary(lmResult)
lmResult
iris_versi
iris_versi<-iris[iris$Species=="versicolor",]
str(iris_versi)
iris_versi
head(iris_versi)
MSE <- mean(lmResult$residuals^2)
RSS <- sum((predict(lmResult) - mean(iris_versi$Petal.Length))^2)
summary(lmResult)$fstatistic
MSE
RSS
MSE <- mean(lmResult$residuals^2)
RSS <- sum((predict(lmResult) - mean(iris_versi$Petal.Length))^2)
summary(lmResult)$fstatistic
library("tidyr")
install.packages("tidyr")
library("tidyr")
PlantGrowth
PlantGrowth$replicates<-c(rep(c(1:10),3))
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
PlantGrowth_wide
PlantGrowth
PlantGrowth_wide
var(PlantGrowth_wide$ctrl)
var(PlantGrowth_wide$trt1)
var(PlantGrowth_wide$trt2)
var.test(PlantGrowth_wide$ctrl,PlantGrowth_wide$trt1)
var.test(PlantGrowth_wide$ctrl,PlantGrowth_wide$trt2)
result <- var.test(PlantGrowth_wide$ctrl, PlantGrowth_wide$trt1)
str(result)
var(PlantGrowth_wide$ctrl)
result$p.value
head(PlantGrowth_wide)
install.packages("ggplot2")
head(PlantGrowth)
p<-ggplot(PlantGrowth,aes(weight,colour=factor(group)))
library("ggplot2")
p<-ggplot(PlantGrowth,aes(weight,colour=factor(group)))
p<-p+geom_box()
p<-ggplot(PlantGrowth,aes(factor(group),weight))
p<-p+geom_boxplot()
p
ggplot(PlantGrowth,aes(factor(group),weight))
+ geom_boxplot()
ggplot(PlantGrowth,aes(factor(group),weight)) +
geom_boxplot()
Life_exp<-read.csv("data/Life_expectancy_at_birth.csv",header=T)
head(Life_exp)
head(PlantGrowth)
boxplot(weight~group,data=PlantGrowth,
col=(c("gold","darkgreen","blue")),
las=2, cex.axis=0.6)
library("tidyr")
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
library("tidyr")
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
head(PlantGrowth_wide)
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
library("tidyr")
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
head(PlantGrowth_wide)
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
head(PlantGrowth_wide)
var(PlantGrowth_wide$ctrl)
var(PlantGrowth_wide$trt1)
var(PlantGrowth_wide$trt2)
var.test(PlantGrowth_wide$ctrl,
PlantGrowth_wide$trt1)
PlantGrowth_wide$trt1)
PlantGrowth_wide$trt2)
vote.leave=17410742
vote.remain=16141241
total.vote=vote.leave+vote.remain
binom.test(vote.leave, total.vote, p=0.5, alternative = "less")
PlantGrowth
data(PlantGrowth)
PlantGrowth
boxplot(weight~group,data=PlantGrowth,
col=(c("gold","darkgreen","blue")),
ylab="Weight")
library("tidyr")
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
head(PlantGrowth_wide)
library("tidyr")
PlantGrowth_wide<-spread(PlantGrowth, group, weight)
head(PlantGrowth_wide)
head(library("tidyr"))
head(PlantGrowth)
PlantGrowthforwide<-PlantGrowth
PlantGrowthforwide$replicate<-rep(c(1:10),3)
PlantGrowthforwide
PlantGrowth_wide<-spread(PlantGrowthforwide, group, weight)
head(PlantGrowth_wide)
?anova
PlantGrowth
lm(formula = weight ~ group, data = PlantGrowth_wide)
PlantGrowth_wide
lm(formula = weight ~ group, data = PlantGrowth)
PG.lm<-lm(formula = weight ~ group, data = PlantGrowth)
anova(PG.lm)
?lm
