---
title: "Answer for Session2: Hypothesis Testing and ANOVA"
author: "MRC Clinical Sciences Centre (http://mrccsc.github.io/)"
date: "12/July/2016"
output: html_document
---

These exercises cover the sections of Statistics in R [Session2: Hypothesis Testing and ANOVA]("Session2_hypothesis_testing.md").

**Exercise 1**

- Read in the file categoriesAndExpression.txt.
```{r,message=T}
 catAndExpr<- read.delim("../data/categoriesAndExpression.txt",header=T)
```
- How many genes are ofInterest and how many in pathways.
```{r,message=T}
 summary(catAndExpr)
```
- What are quantiles of expression overall, in Glycolysis genes and in TGFb genes.
```{r,message=T}
 summary(catAndExpr)
 summary(catAndExpr[catAndExpr$pathway == "Glycolysis",])
 summary(catAndExpr[catAndExpr$pathway == "TGFb",])
```
- How many genes were selected and in Glycolysis pathway.
```{r,message=T}
contingency <- ftable(catAndExpr[,c("ofInterest","pathway")])
contingency
catAndExpr$ofInterest<-relevel(catAndExpr$ofInterest,ref="Selected")
contingency <- ftable(catAndExpr[,c("ofInterest","pathway")])
contingency
#fisher.test(contingency)

```
- Given a normal distibution for the data, what is the probablity of selecting a gene with at least the expression level of "Gene13"
```{r,message=T}
meanExpression <- mean(catAndExpr$Expr)
sdExpression <- sd(catAndExpr$Expr)
Gene13Expression <- catAndExpr[catAndExpr$geneName == "Gene13",]$Expression
1-pnorm(Gene13Expression,meanExpression,sdExpression)
```

- Perform a t-test to evaluate the difference between Glycolysis and TGFb pathway.
```{r,message=T}
glycolysisExpression <- catAndExpr[catAndExpr$pathway == "Glycolysis",]$Expression
tgfbExpression <- catAndExpr[catAndExpr$pathway == "TGFb",]$Expression
var.test(glycolysisExpression,tgfbExpression)
t.test(glycolysisExpression,tgfbExpression,var.equal = FALSE)
```



